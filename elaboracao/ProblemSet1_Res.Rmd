```{r packages}
# rm(list = ls())
library(tidyverse)
library(conflicted)
library(tictoc)     # timing
```

$${\displaystyle f(x|\text{min},\text{max},\text{mean})={\begin{cases}
    {\frac {2(x-\text{min})}{(\text{max}-\text{min})(\text{mean}-\text{min})}}&,\;\text{min}\leq x=\text{mean}\\
    &\\{\frac {2}{\text{max}-\text{min}}}&,\;x=\text{mean}\\
    &\\{\frac {2(\text{max}-x)}{(\text{max}-\text{min})(\text{max}-\text{mean})}}&,\;\text{mean}<x\leq \text{max}
\end{cases}}}$$

```{r distribuição-triangular}
pdf_triang_abc <- function(x, a, b, c) {
  case_when(
    x < a || x > b   ~ 0,
    x < c            ~ 2 * (x - a) / ((b - a) * (c - a)),
    x == c           ~ 2 / (b - a),
    c < x            ~ 2 * (b - x) / ((b - a) * (b - c)),
    TRUE             ~ NA_real_
  )
}
pdf_triang <- \(x, min, max, mode) pdf_triang_abc(x, min, max, mode)
pdf <- pdf_triang_abc

extraDistr::dtriang(2,1,3,2.5)
pdf(2,1,3,2.5)
```


```{r}
generate_triangular_random <- function(n, min_value, max_value, mode_value) {
  k <- 0
  j <- 0
  y <- numeric(n)
  while (k < n) {
    u <- runif(1)
    j <- j + 1
    x <- runif(1, min_value, max_value)
    dist_trg <- dist_triangular(x, min_value, max_value, mode_value)
    if (u <= dist_trg) {
      k <- k + 1
      y[k] <- x
    }
  }
  return(y)
}
```

```{r plots}
set.seed(2023)
tic()
NPA <- generate_triangular_random(10000, 0, 10, 5) %>%
  data.frame(NPA = .)
toc()
# Densidade dos NPA gerados
density_plot <- ggplot(NPA, aes(x = NPA)) +
  geom_density(fill = "blue", alpha = 0.5) +
  labs(x = "NPA", y = "Densidade") +
  ggtitle("Densidade dos NPA Gerados")

toc(log = TRUE)
print(density_plot)

# TODO gráfico (fiz um simples, mas seria interessante fazer o triângulo da distrib.)
```


## Exercício 2

$s_1=\displaystyle\frac{Q_3-Q_1-2Q_2}{Q_3-Q_1}$

$s_2=\displaystyle\frac{(\mu-\upsilon)}{E(|X-\upsilon|)}$


```{r}
# TODO
```




