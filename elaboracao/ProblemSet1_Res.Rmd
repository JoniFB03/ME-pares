```{r packages}
# rm(list = ls())
library(tidyverse)
library(conflicted)
library(tictoc)     # timing
library(e1071)
```


https://en.wikipedia.org/wiki/Triangular_distribution

$$
f(x | a, b, c) = 
\begin{cases}
  0                         & \text{se} \; x < a \\
  \frac{2(x-a)}{(b-a)(c-a)} & \text{se} \; a \leq x < c \\
  \frac{2}{b-a}             & \text{se} \; x = c \\
  \frac{2(b-x)}{(b-a)(b-c)} & \text{se} \; c < x \leq b \\
  0                         & \text{se} \; x > b
\end{cases}
$$

```{r distribuição-triangular}
dist_triangular <- function(x, min_value, max_value, mode_value) {
  if (x <= mode_value) {
    return(2 * (x - min_value) / ((max_value - min_value) * (mode_value - min_value)))
  } else {
    return(2 * (max_value - x) / ((max_value - min_value) * (max_value - mode_value)))
  }
}
pdf_triang <- \(x, min, max, mode) dist_triangular(x, min, max, mode)
pdf <- dist_triangular

extraDistr::dtriang(4, 1, 3, 2.5)
pdf(2, 1, 3, 2.5)
```


```{r}
aceitacao_rejeicao_triang <- function(n, min_value, max_value, mode_value) {
  k <- 0
  j <- 0
  y <- numeric(n)
  while (k < n) {
    u <- runif(1)
    j <- j + 1
    x <- runif(1, min_value, max_value)
    dist_trg <- dist_triangular(x, min_value, max_value, mode_value)
    if (u <= dist_trg) {
      k <- k + 1
      y[k] <- x
    }
  }
  return(y)
}
```

```{r plots}
set.seed(2023)
tic()
NPA <- aceitacao_rejeicao_triang(10000, 0, 10, 2) %>%
  data.frame(NPA = .)
toc()
# Densidade dos NPA gerados
density_plot <- ggplot(NPA, aes(x = NPA)) +
  geom_density(fill = "blue", alpha = 0.5) +
  labs(x = "NPA", y = "Densidade") +
  ggtitle("Densidade dos NPA Gerados")
print(density_plot)

# TODO gráfico (fiz um simples, mas seria interessante fazer o triângulo da distrib.)
```


## Exercício 2


https://en.wikipedia.org/wiki/Skewness

#### Quantile-based measures
$s_1=\displaystyle\frac{Q_3+Q_1-2Q_2}{Q_3-Q_1}$


#### Groeneveld and Meeden's coefficient
$s_2=\displaystyle\frac{(\mu-\nu)}{E(|X-\nu|)}$


### alínea a)

```{r}
set.seed(2023)

n_i <- 20
n_ii <- 100
n_iii <- 1000

# numero de amostras
n_amostras <- 100

# ?rt
# Student-t
amostras_i <- matrix(rt(n = n_i * n_amostras, df = n_i), nrow = n_i)
amostras_ii <- matrix(rt(n = n_ii * n_amostras, df = n_ii), nrow = n_ii)
amostras_iii <- matrix(rt(n = n_iii * n_amostras, df = n_iii), nrow = n_iii)
```

### alínea b)

```{r}
estim_s1 <- function(x){
  Q1 <- quantile(x, 0.25)
  Q2 <- quantile(x, 0.5)
  Q3 <- quantile(x, 0.75)
  return ((Q3+Q1-2*Q2)/(Q3-Q1))
}

estim_s2 <- function(x){
  miu <- mean(x)
  nu <- median(x)
  return ((miu - nu)/mean(abs(x - nu)))
}

# ?apply

(skewA_ai1 <- mean(apply(amostras_i, MARGIN = 2, FUN = estim_s1)))
(skewA_ai2 <- mean(apply(amostras_i, MARGIN = 2, FUN = estim_s2)))

(skewA_aii1 <- mean(apply(amostras_ii, MARGIN = 2, FUN = estim_s1)))
(skewA_aii2 <- mean(apply(amostras_ii, MARGIN = 2, FUN = estim_s2)))

(skewA_aiii1 <- mean(apply(amostras_iii, MARGIN = 2, FUN = estim_s1)))
(skewA_aiii2 <- mean(apply(amostras_iii, MARGIN = 2, FUN = estim_s2)))
```

### alínea c)

```{r}
# TODO, n me apeteceu
```


